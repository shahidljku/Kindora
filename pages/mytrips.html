<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kindora ‚Äì My Trips</title>
    <link rel="icon" type="image/png" href="kindora-logo.ico" />
    <link href="common_nav_footer.css" rel="stylesheet" />
    <style>
      body {
        font-family: "Open Sans", sans-serif;
        background: #f9fafb;
        margin: 0;
        padding: 20px;
      }
      .container {
        max-width: 900px;
        margin: auto;
        background: #fff;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #1e40af;
      }
      .trip {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
        background: #fafafa;
      }
      .trip h3 {
        margin: 0 0 10px;
        color: #059669;
      }
      .detail {
        margin: 4px 0;
      }
      .label {
        font-weight: 600;
        color: #444;
      }
    </style>
  </head>
  <body>
    <div id="nav1">
      <a href="home.html" id="logo-link">
        <div id="logo">Kindora</div>
      </a>

      <div id="nav2">
        <div class="inspire-wrapper">
          <a class="a1 dropbtn" id="inspireBtn" href="#">Be Inspired</a>
          <div class="scroll-container1" id="inspireScroll">
            <a data-href="asia.html">
              <div class="image-wrapper1">
                <img src="web images/banner/asia.jpg" alt="Asia" />
                <div class="overlay-text">Asia</div>
              </div>
            </a>

            <a data-href="europe.html">
              <div class="image-wrapper1">
                <img src="web images/banner/europe.jpeg" alt="Europe" />
                <div class="overlay-text">Europe</div>
              </div>
            </a>

            <a data-href="africa.html">
              <div class="image-wrapper1">
                <img src="web images/banner/africa.jpg" alt="Africa" />
                <div class="overlay-text">Africa</div>
              </div>
            </a>

            <a data-href="north_america.html">
              <div class="image-wrapper1">
                <img
                  src="web images/banner/north america.jpg"
                  alt="North America"
                />
                <div class="overlay-text">North America</div>
              </div>
            </a>

            <a data-href="south_america.html">
              <div class="image-wrapper1">
                <img src="7 wonders/Machu Picchu.jpeg" alt="South America" />
                <div class="overlay-text">South America</div>
              </div>
            </a>

            <a data-href="australia.html">
              <div class="image-wrapper1">
                <img src="web images/banner/australia.jpg" alt="Australia" />
                <div class="overlay-text">Australia</div>
              </div>
            </a>

            <a data-href="antarctica.html">
              <div class="image-wrapper1">
                <img src="web images/banner/antarctica.jpeg" alt="Antarctica" />
                <div class="overlay-text">Antarctica</div>
              </div>
            </a>
          </div>
        </div>

        <a class="a1 dropbtn" href="explore.html">Places to go</a>
        <a class="a1 dropbtn" href="things_to_do.html">Things to do</a>
        <a class="a1 dropbtn" href="booking.php">Plan Your Trip</a>
      </div>

      <button class="menu" onclick="toggleMenu()">‚ò∞</button>

      <div id="sidebar" class="sidebar">
        <button class="closebtn" onclick="toggleMenu()">√ó</button>
        <a href="home.html">Home</a>
        <a href="login.php">Login/Register</a>
        <a href="booking.php">Book Your Trips</a>
        <a href="mytrips.html">My Trips</a>
        <a href="aboutus.html">About</a>
        <a href="contactus.html">Contact</a>
      </div>
    </div>
    <br /><br /><br /><br />
    <br /><br /><br /><br />
    <div class="container">
      <h1>My Trips</h1>
      <div class="trips-dashboard">
        <!-- User Welcome -->
        <div class="user-welcome">
          <h2>Welcome back, <span id="userName">Traveler</span>! üåç</h2>
          <p>Manage your bookings and explore new destinations</p>
        </div>

        <!-- Trip Stats -->
        <div class="trip-stats">
          <div class="stat-card">
            <h3 id="totalTrips">0</h3>
            <p>Total Trips</p>
          </div>
          <div class="stat-card">
            <h3 id="upcomingTrips">0</h3>
            <p>Upcoming</p>
          </div>
          <div class="stat-card">
            <h3 id="rewardPoints">0</h3>
            <p>Reward Points</p>
          </div>
        </div>

        <!-- My Trips List -->
        <div class="trips-section">
          <h3>üìã Your Booked Trips</h3>
          <div id="tripsContainer">
            <!-- Trips will load here -->
          </div>
        </div>

        <!-- Saved Destinations -->
        <div class="saved-section">
          <h3>üíñ Saved Destinations</h3>
          <div id="savedContainer">
            <!-- Saved places will load here -->
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
          <a href="booking.php" class="action-btn book-btn">üìÖ Book New Trip</a>
          <a href="explore.html" class="action-btn explore-btn"
            >üîç Explore Destinations</a
          >
          <button onclick="logout()" class="action-btn logout-btn">
            üö™ Logout
          </button>
        </div>
      </div>

      <style>
        .trips-dashboard {
          margin-top: 120px;
          padding: 20px;
          max-width: 1200px;
          margin-left: auto;
          margin-right: auto;
        }

        .user-welcome {
          text-align: center;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 30px;
          border-radius: 15px;
          margin-bottom: 30px;
        }

        .user-welcome h2 {
          font-size: 2rem;
          margin-bottom: 10px;
        }

        .trip-stats {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: 20px;
          margin-bottom: 40px;
        }

        .stat-card {
          background: white;
          padding: 20px;
          border-radius: 12px;
          text-align: center;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
          font-size: 2rem;
          color: #003366;
          margin-bottom: 5px;
        }

        .trips-section,
        .saved-section {
          margin-bottom: 40px;
        }

        .trips-section h3,
        .saved-section h3 {
          color: #003366;
          margin-bottom: 20px;
          font-size: 1.5rem;
        }

        .trip-card {
          background: white;
          border: 1px solid #e0e0e0;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 15px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .trip-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
        }

        .trip-header h4 {
          color: #003366;
          font-size: 1.2rem;
        }

        .status {
          padding: 4px 12px;
          border-radius: 15px;
          font-size: 0.8rem;
          font-weight: bold;
        }

        .status.confirmed {
          background: #d4edda;
          color: #155724;
        }

        .status.pending {
          background: #fff3cd;
          color: #856404;
        }

        .trip-details {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 10px;
          margin-bottom: 15px;
        }

        .trip-actions {
          display: flex;
          gap: 10px;
        }

        .trip-actions button {
          padding: 6px 12px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-size: 0.9rem;
        }

        .view-btn {
          background: #e3f2fd;
          color: #1976d2;
        }

        .modify-btn {
          background: #fff3e0;
          color: #f57c00;
        }

        .cancel-btn {
          background: #ffebee;
          color: #d32f2f;
        }

        .saved-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 15px;
        }

        .saved-item {
          background: #f8f9fa;
          padding: 15px;
          border-radius: 8px;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .quick-actions {
          display: flex;
          gap: 15px;
          justify-content: center;
          flex-wrap: wrap;
          margin-top: 30px;
        }

        .action-btn {
          padding: 12px 24px;
          border-radius: 8px;
          text-decoration: none;
          font-weight: bold;
          border: none;
          cursor: pointer;
          transition: all 0.3s ease;
        }

        .book-btn {
          background: #ffcc00;
          color: #003366;
        }

        .explore-btn {
          background: #667eea;
          color: white;
        }

        .logout-btn {
          background: #ff6b6b;
          color: white;
        }

        .no-content {
          text-align: center;
          padding: 40px;
          background: #f8f9fa;
          border-radius: 12px;
          color: #666;
        }
      </style>

      <script src="users.js"></script>
      <script>
        // Load user data when page loads
        document.addEventListener("DOMContentLoaded", function () {
          loadUserData();
        });

        function loadUserData() {
          const currentUser = JSON.parse(localStorage.getItem("currentUser"));

          if (!currentUser) {
            alert("üîí Please login first!");
            window.location.href = "login.php";
            return;
          }

          // Update user name
          document.getElementById("userName").textContent =
            currentUser.fullName || currentUser.username;

          // Update stats
          const totalTrips = currentUser.bookedTrips
            ? currentUser.bookedTrips.length
            : 0;
          const upcomingTrips = currentUser.bookedTrips
            ? currentUser.bookedTrips.filter(
                (trip) =>
                  trip.status === "confirmed" || trip.status === "pending"
              ).length
            : 0;

          document.getElementById("totalTrips").textContent = totalTrips;
          document.getElementById("upcomingTrips").textContent = upcomingTrips;
          document.getElementById("rewardPoints").textContent =
            currentUser.rewardPoints || 0;

          // Load trips
          loadTrips(currentUser.bookedTrips);

          // Load saved destinations
          loadSavedDestinations(currentUser.savedDestinations);
        }

        function loadTrips(trips) {
          const container = document.getElementById("tripsContainer");

          if (trips && trips.length > 0) {
            container.innerHTML = trips
              .map(
                (trip) => `
            <div class="trip-card">
                <div class="trip-header">
                    <h4>${trip.destination}</h4>
                    <span class="status ${
                      trip.status
                    }">${trip.status.toUpperCase()}</span>
                </div>
                <div class="trip-details">
                    <p><strong>üìÖ Date:</strong> ${trip.date}</p>
                    <p><strong>üí∞ Amount:</strong> ${trip.amount}</p>
                    <p><strong>üì¶ Package:</strong> ${trip.package}</p>
                    <p><strong>üÜî Trip ID:</strong> ${trip.id}</p>
                </div>
                <div class="trip-actions">
                    <button onclick="viewTrip('${
                      trip.id
                    }')" class="view-btn">üëÅÔ∏è View</button>
                    <button onclick="modifyTrip('${
                      trip.id
                    }')" class="modify-btn">‚úèÔ∏è Modify</button>
                    <button onclick="cancelTrip('${
                      trip.id
                    }')" class="cancel-btn">‚ùå Cancel</button>
                </div>
            </div>
        `
              )
              .join("");
          } else {
            container.innerHTML = `
            <div class="no-content">
                <h3>No trips booked yet! üåç</h3>
                <p>Start planning your next adventure</p>
                <a href="booking.php" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: #ffcc00; color: #003366; text-decoration: none; border-radius: 8px; font-weight: bold;">Book Your First Trip</a>
            </div>
        `;
          }
        }

        function loadSavedDestinations(saved) {
          const container = document.getElementById("savedContainer");

          if (saved && saved.length > 0) {
            container.innerHTML = `
            <div class="saved-grid">
                ${saved
                  .map(
                    (dest) => `
                    <div class="saved-item">
                        <span>üìç ${dest}</span>
                        <button onclick="removeSaved('${dest}')" style="background: #ff6b6b; color: white; border: none; width: 25px; height: 25px; border-radius: 50%; cursor: pointer;">√ó</button>
                    </div>
                `
                  )
                  .join("")}
            </div>
        `;
          } else {
            container.innerHTML = `
            <div class="no-content">
                <p>No saved destinations yet üí≠</p>
                <a href="explore.html" style="display: inline-block; margin-top: 10px; padding: 8px 16px; background: #667eea; color: white; text-decoration: none; border-radius: 6px;">Explore Now</a>
            </div>
        `;
          }
        }

        // Trip action functions
        function viewTrip(tripId) {
          const currentUser = JSON.parse(localStorage.getItem("currentUser"));
          const trip = currentUser.bookedTrips.find((t) => t.id === tripId);

          if (trip) {
            alert(`
üß≥ TRIP DETAILS:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìç Destination: ${trip.destination}
üìÖ Travel Date: ${trip.date}
üì¶ Package: ${trip.package}
üí∞ Amount: ${trip.amount}
üìä Status: ${trip.status.toUpperCase()}
üìù Booked On: ${trip.bookingDate}
üÜî Trip ID: ${trip.id}
        `);
          }
        }

        function modifyTrip(tripId) {
          alert("üîß Modify Trip Feature Coming Soon!\n\nTrip ID: " + tripId);
        }

        function cancelTrip(tripId) {
          if (
            confirm(
              "‚ö†Ô∏è Are you sure you want to cancel this trip?\n\nThis action cannot be undone."
            )
          ) {
            const currentUser = JSON.parse(localStorage.getItem("currentUser"));

            // Find and update trip status
            const tripIndex = currentUser.bookedTrips.findIndex(
              (t) => t.id === tripId
            );
            if (tripIndex !== -1) {
              currentUser.bookedTrips[tripIndex].status = "cancelled";
              localStorage.setItem("currentUser", JSON.stringify(currentUser));

              // Reload the page to show updated status
              loadUserData();

              alert("‚ùå Trip cancelled successfully!");
            }
          }
        }

        function removeSaved(destination) {
          const currentUser = JSON.parse(localStorage.getItem("currentUser"));

          if (currentUser.savedDestinations) {
            currentUser.savedDestinations =
              currentUser.savedDestinations.filter(
                (dest) => dest !== destination
              );
            localStorage.setItem("currentUser", JSON.stringify(currentUser));
            loadSavedDestinations(currentUser.savedDestinations);
          }

          alert(`üíî ${destination} removed from saved destinations.`);
        }

        function logout() {
          if (confirm("Are you sure you want to logout?")) {
            localStorage.removeItem("currentUser");
            localStorage.removeItem("isLoggedIn");
            alert("üëã Logged out successfully!");
            window.location.href = "home.html";
          }
        }
      </script>
      <script>
        document.querySelectorAll(".scroll-container1 a").forEach((a) => {
          a.addEventListener("dblclick", (e) => {
            const href = a.getAttribute("data-href");
            if (href) {
              window.location.href = href;
            }
          });

          a.addEventListener("click", (e) => {
            e.preventDefault();
          });
        });

        function toggleMenu() {
          document.getElementById("sidebar").classList.toggle("open");
        }
        document.querySelector(".cta-btn").addEventListener("click", () => {
          document.getElementById("popular").scrollIntoView({
            behavior: "smooth",
          });
        });
      </script>
      <script>
        // --- FAQ Accordion (only one open at a time) ---
        const faqQuestions = document.querySelectorAll(".faq-question");

        faqQuestions.forEach((btn) => {
          btn.addEventListener("click", () => {
            // Close all
            faqQuestions.forEach((q) => {
              if (q !== btn) {
                q.classList.remove("active");
                q.nextElementSibling.classList.remove("open");
              }
            });

            // Toggle clicked one
            btn.classList.toggle("active");
            btn.nextElementSibling.classList.toggle("open");
          });
        });
      </script>
      <script>
        const inspireBtn = document.getElementById("inspireBtn");
        const scrollContainer = document.getElementById("inspireScroll");

        inspireBtn.addEventListener("click", function (e) {
          e.preventDefault();
          if (scrollContainer.style.display === "flex") {
            scrollContainer.style.display = "none";
          } else {
            scrollContainer.style.display = "flex";
          }
        });
      </script>
    </div>
  </body>
</html>
