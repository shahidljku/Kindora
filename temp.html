<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kindora ‚Äî Feature Demo</title>
    <link rel="preconnect" href="https://images.unsplash.com" />
    <link rel="icon" type="image/png" href="kindora-logo.ico" />
    <style>
      :root {
        --bg: #ffffff;
        --text: #0b1b2b;
        --muted: #5b728a;
        --brand: #113f67;
        --brand-2: #145a8d;
        --card: #f6f9fc;
        --accent: #ffcc00;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Inter,
          sans-serif;
        color: var(--text);
        background: var(--bg);
        line-height: 1.5;
      }
      a {
        text-decoration: none;
        color: inherit;
      }
      img {
        max-width: 100%;
        display: block;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Top progress bar */
      #progress {
        position: fixed;
        top: 0;
        left: 0;
        height: 4px;
        width: 0;
        background: linear-gradient(90deg, var(--accent), #ffd633);
        z-index: 9999;
      }

      /* Navbar */
      nav {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: saturate(180%) blur(8px);
        border-bottom: 1px solid #e9eef5;
      }
      nav .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 20px;
      }
      .brand {
        font-weight: 800;
        font-size: 1.4rem;
        color: var(--brand);
      }
      .nav-links {
        display: flex;
        gap: 18px;
      }
      .nav-links a {
        padding: 8px 10px;
        border-radius: 10px;
      }
      /* no hover visuals per prior requests */

      .btn {
        background: var(--brand);
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 10px 16px;
        cursor: pointer;
      }
      .btn.secondary {
        background: var(--brand-2);
      }
      .btn.ghost {
        background: #e9f1fb;
        color: var(--brand);
      }

      .section {
        padding: 60px 0;
      }
      .section h2 {
        font-size: 2rem;
        margin-bottom: 14px;
        color: var(--brand);
      }
      .muted {
        color: var(--muted);
      }

      /* Hero */
      .hero {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: 24px;
        align-items: center;
      }
      .hero .card {
        background: var(--card);
        padding: 18px;
        border-radius: 16px;
      }

      /* Search + Filters */
      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
      }
      .filters input,
      .filters select {
        padding: 10px;
        border: 1px solid #d9e1ea;
        border-radius: 10px;
        min-width: 180px;
      }

      /* Gallery */
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 16px;
      }
      .tile {
        position: relative;
        border-radius: 14px;
        overflow: hidden;
        background: #000;
      }
      .tile img {
        width: 100%;
        height: 220px;
        object-fit: cover;
        transition: transform 0.35s ease;
      }
      .tile:hover img {
        transform: scale(1.05);
      }
      .tile .cap {
        position: absolute;
        left: 12px;
        bottom: 12px;
        background: rgba(0, 0, 0, 0.55);
        color: #fff;
        padding: 6px 10px;
        border-radius: 10px;
        font-size: 0.95rem;
      }
      .tile button {
        position: absolute;
        top: 10px;
        right: 10px;
      }

      /* Lightbox */
      .lightbox {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.9);
        display: none;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 2000;
      }
      .lightbox img {
        max-width: 90%;
        max-height: 75%;
        border-radius: 12px;
      }
      .lb-controls {
        margin-top: 14px;
        display: flex;
        gap: 10px;
      }

      /* Booking Widget */
      .book-wrap {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 18px;
      }
      .card {
        background: var(--card);
        padding: 18px;
        border-radius: 16px;
      }
      .field {
        display: grid;
        gap: 6px;
        margin-bottom: 10px;
      }
      .field input,
      .field select {
        padding: 10px;
        border: 1px solid #d9e1ea;
        border-radius: 10px;
      }
      .price {
        font-size: 1.4rem;
        font-weight: 700;
        color: #0a3a62;
      }

      /* Itinerary */
      .itinerary {
        display: grid;
        gap: 10px;
        margin-top: 10px;
      }
      .day {
        background: #fff;
        border: 1px solid #e6edf5;
        border-radius: 12px;
        padding: 12px;
      }

      /* Reviews */
      .reviews {
        display: grid;
        gap: 10px;
      }
      .review {
        background: #fff;
        border: 1px solid #e6edf5;
        border-radius: 12px;
        padding: 12px;
      }
      .stars {
        color: #ffb400;
      }

      /* Testimonials carousel */
      .carousel {
        position: relative;
        overflow: hidden;
        border-radius: 16px;
      }
      .carousel-track {
        display: flex;
        gap: 16px;
        animation: slide 20s linear infinite;
      }
      .t-item {
        min-width: 280px;
        background: #0e2f4d;
        color: #fff;
        padding: 18px;
        border-radius: 16px;
      }
      @keyframes slide {
        0% {
          transform: translateX(0);
        }
        100% {
          transform: translateX(-50%);
        }
      }

      /* Counters */
      .counters {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
      }
      .counter {
        background: #0e2f4d;
        color: #fff;
        border-radius: 16px;
        padding: 18px;
        text-align: center;
      }
      .counter b {
        font-size: 1.8rem;
      }

      /* Poll */
      .poll {
        display: grid;
        gap: 8px;
      }
      .poll .bar {
        height: 10px;
        background: #e6edf5;
        border-radius: 999px;
        overflow: hidden;
      }
      .poll .bar > span {
        display: block;
        height: 100%;
        background: var(--brand);
        width: 0;
      }

      /* Back to top */
      #toTop {
        position: fixed;
        right: 16px;
        bottom: 16px;
        z-index: 1200;
      }

      /* Dark mode */
      .dark {
        --bg: #0a0f14;
        --text: #e6edf5;
        --muted: #a6b2bf;
        --card: #0f1722;
      }

      /* Floating WhatsApp */
      .wa {
        position: fixed;
        left: 16px;
        bottom: 16px;
        background: #25d366;
        color: #fff;
        padding: 12px 14px;
        border-radius: 999px;
        font-weight: 700;
        z-index: 1300;
      }

      /* Countdown */
      .countdown {
        display: flex;
        gap: 10px;
      }
      .cd-box {
        background: #0e2f4d;
        color: #fff;
        padding: 12px 16px;
        border-radius: 12px;
        text-align: center;
      }

      /* Footer */
      footer {
        margin-top: 60px;
        background: #031a2e;
        color: #c9d6e6;
      }
      footer .cols {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        padding: 30px 20px;
      }
      footer h4 {
        color: #ffd633;
        margin-bottom: 10px;
      }
      footer input,
      footer button {
        padding: 10px;
        border: none;
        border-radius: 8px;
      }
      footer button {
        background: var(--accent);
        color: #002244;
        font-weight: 700;
      }

      /* Simple map substitute grid */
      .map-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 12px;
      }
      .map-card {
        background: #fff;
        border: 1px solid #e6edf5;
        border-radius: 12px;
        padding: 12px;
      }

      /* Hidden for lazy animation reveal */
      .reveal {
        opacity: 0;
        transform: translateY(12px);
        transition: all 0.6s ease;
      }
      .reveal.show {
        opacity: 1;
        transform: none;
      }
    </style>
  </head>
  <body>
    <div id="progress"></div>
    <nav>
      <div class="row container">
        <div class="brand">Kindora</div>
        <div class="nav-links">
          <a href="#gallery">Gallery</a>
          <a href="#booking">Booking</a>
          <a href="#itinerary">Itinerary</a>
          <a href="#tools">Tools</a>
          <a href="#community">Community</a>
        </div>
        <button id="mode" class="btn ghost" aria-label="Toggle theme">
          üåô
        </button>
      </div>
    </nav>

    <header class="section">
      <div class="container hero">
        <div>
          <h1 style="font-size: 2.4rem; color: var(--brand)">
            Plan. Explore. Remember.
          </h1>
          <p class="muted" style="margin-top: 6px">
            All-in-one demo bringing booking, calculators, reviews, polls,
            countdowns, and more ‚Äî in a single file.
          </p>
          <div class="card" style="margin-top: 14px">
            <div class="filters">
              <input
                id="search"
                type="search"
                placeholder="Search destination..."
              />
              <select id="category">
                <option value="all">All</option>
                <option value="city">Cities</option>
                <option value="beach">Beaches</option>
                <option value="mountain">Mountains</option>
              </select>
              <select id="sort">
                <option value="popular">Sort: Popular</option>
                <option value="name">Sort: Name</option>
              </select>
              <button class="btn" id="voice">üé§ Voice Search</button>
            </div>
          </div>
        </div>
        <div class="card">
          <h3 style="margin-bottom: 8px">Limited Offer</h3>
          <p class="muted">Summer Splash Sale ends in:</p>
          <div class="countdown" style="margin-top: 10px">
            <div class="cd-box">
              <div id="d">0</div>
              <small>Days</small>
            </div>
            <div class="cd-box">
              <div id="h">0</div>
              <small>Hours</small>
            </div>
            <div class="cd-box">
              <div id="m">0</div>
              <small>Min</small>
            </div>
            <div class="cd-box">
              <div id="s">0</div>
              <small>Sec</small>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section id="gallery" class="section">
      <div class="container">
        <h2>Gallery</h2>
        <p class="muted">
          Click a photo to open lightbox. Trending counts update when users view
          tiles.
        </p>
        <div class="grid" id="grid"></div>
        <div style="text-align: center; margin-top: 16px">
          <button id="loadMore" class="btn ghost">Load more</button>
        </div>
      </div>
    </section>

    <div class="lightbox" id="lightbox">
      <img id="lbImg" alt="Preview" />
      <div class="lb-controls">
        <button class="btn" id="prev">‚èÆ Prev</button>
        <button class="btn" id="next">Next ‚è≠</button>
        <button class="btn secondary" id="slide">‚ñ∂ Slideshow</button>
        <button class="btn ghost" id="dl">‚¨á Download</button>
        <button class="btn ghost" id="fs">‚õ∂ Fullscreen</button>
        <button class="btn" id="close">Close</button>
      </div>
    </div>

    <section id="booking" class="section">
      <div class="container book-wrap">
        <div class="card">
          <h2>Booking</h2>
          <div class="field">
            <label>Destination</label>
            <select id="dest">
              <option value="Paris" data-base="180">Paris</option>
              <option value="Tokyo" data-base="220">Tokyo</option>
              <option value="Maldives" data-base="250">Maldives</option>
              <option value="Rome" data-base="160">Rome</option>
              <option value="Switzerland" data-base="240">Switzerland</option>
              <option value="New York" data-base="210">New York</option>
            </select>
          </div>
          <div class="field">
            <label>Start Date</label><input type="date" id="start" />
          </div>
          <div class="field">
            <label>Nights</label
            ><input type="number" id="nights" min="1" value="5" />
          </div>
          <div class="field">
            <label>Travelers</label
            ><input type="number" id="pax" min="1" value="2" />
          </div>
          <div class="field">
            <label>Coupon</label
            ><input type="text" id="coupon" placeholder="e.g. SUMMER10" />
          </div>
          <div class="field">
            <label>Currency</label>
            <select id="ccy">
              <option value="USD">USD</option>
              <option value="INR" selected>INR</option>
              <option value="EUR">EUR</option>
            </select>
          </div>
          <div class="price" id="price">‚Äî</div>
          <div style="display: flex; gap: 10px; margin-top: 10px">
            <button class="btn" id="calc">Calculate</button>
            <button class="btn secondary" id="book">Book (Demo)</button>
          </div>
          <p class="muted" style="margin-top: 8px">
            Demo only: pricing is estimated. Coupons: <b>SUMMER10</b> (10%),
            <b>WINTER15</b> (15%).
          </p>
        </div>
        <div class="card">
          <h2>Trip Tools</h2>
          <div class="field">
            <label>Days</label
            ><input type="number" id="days" min="1" value="4" />
          </div>
          <button class="btn" id="genPlan">Generate Itinerary</button>
          <div class="itinerary" id="plan"></div>
          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #dbe6f1"
          />
          <h3>Live Weather</h3>
          <div class="field">
            <label>City</label
            ><input id="wxCity" placeholder="Enter city e.g. Paris" />
          </div>
          <button class="btn ghost" id="getWx">Get Weather</button>
          <div id="weather" class="muted" style="margin-top: 8px"></div>
          <hr
            style="margin: 14px 0; border: none; border-top: 1px solid #dbe6f1"
          />
          <h3>Currency Converter</h3>
          <div class="field">
            <label>Amount</label><input id="amt" type="number" value="100" />
          </div>
          <div class="field">
            <label>From</label>
            <select id="fromC">
              <option>USD</option>
              <option selected>INR</option>
              <option>EUR</option>
            </select>
          </div>
          <div class="field">
            <label>To</label>
            <select id="toC">
              <option selected>USD</option>
              <option>INR</option>
              <option>EUR</option>
            </select>
          </div>
          <button class="btn ghost" id="fx">Convert</button>
          <div id="fxOut" style="margin-top: 8px"></div>
        </div>
      </div>
    </section>

    <section id="tools" class="section">
      <div class="container">
        <h2>Interactive Map (Quick Picks)</h2>
        <div class="map-grid reveal" id="mapGrid"></div>
        <hr
          style="margin: 24px 0; border: none; border-top: 1px solid #dbe6f1"
        />
        <h2>Stats & Social Proof</h2>
        <div class="counters reveal" id="counters">
          <div class="counter">
            <b data-count="120">0</b>
            <div class="muted">Destinations</div>
          </div>
          <div class="counter">
            <b data-count="580">0</b>
            <div class="muted">Happy Travelers</div>
          </div>
          <div class="counter">
            <b data-count="96">0</b>
            <div class="muted">5‚òÖ Reviews</div>
          </div>
          <div class="counter">
            <b data-count="24">0</b>
            <div class="muted">Guides</div>
          </div>
        </div>
        <div class="carousel" style="margin-top: 16px">
          <div class="carousel-track">
            <div class="t-item">‚ÄúBest trip of my life!‚Äù ‚Äî Aisha</div>
            <div class="t-item">‚ÄúSuper smooth planning.‚Äù ‚Äî Luca</div>
            <div class="t-item">‚ÄúGreat prices & support.‚Äù ‚Äî Maya</div>
            <div class="t-item">‚ÄúLoved the itinerary generator.‚Äù ‚Äî Aarav</div>
            <div class="t-item">‚ÄúBooked Maldives in minutes.‚Äù ‚Äî Zoe</div>
            <div class="t-item">
              ‚ÄúFamily trip to Tokyo was perfect.‚Äù ‚Äî Daniel
            </div>
          </div>
        </div>
        <hr
          style="margin: 24px 0; border: none; border-top: 1px solid #dbe6f1"
        />
        <h2>Poll: What should we feature next?</h2>
        <div class="poll reveal">
          <div style="display: flex; gap: 10px; flex-wrap: wrap">
            <button class="btn" data-poll="beach">Beaches</button>
            <button class="btn" data-poll="mountain">Mountains</button>
            <button class="btn" data-poll="city">City Breaks</button>
          </div>
          <div class="bar"><span id="pollBar"></span></div>
          <div class="muted" id="pollOut">Vote to see results</div>
        </div>
      </div>
    </section>

    <section id="community" class="section">
      <div class="container">
        <h2>Community</h2>
        <div class="card" style="margin-bottom: 16px">
          <h3>Leave a Review</h3>
          <div class="field">
            <label>Name</label><input id="rName" placeholder="Your name" />
          </div>
          <div class="field">
            <label>Rating</label>
            <select id="rStars">
              <option>5</option>
              <option>4</option>
              <option>3</option>
              <option>2</option>
              <option>1</option>
            </select>
          </div>
          <div class="field">
            <label>Comment</label
            ><input id="rText" placeholder="Your experience" />
          </div>
          <button class="btn" id="addReview">Submit</button>
        </div>
        <div class="reviews" id="reviews"></div>
      </div>
    </section>

    <footer>
      <div class="container cols">
        <div>
          <h4>Kindora</h4>
          <p>
            Your gateway to dream destinations. Explore, travel, and create
            unforgettable memories.
          </p>
        </div>
        <div>
          <h4>Quick Links</h4>
          <p>
            <a href="#gallery">Gallery</a> ¬∑ <a href="#booking">Booking</a> ¬∑
            <a href="#itinerary">Itinerary</a>
          </p>
        </div>
        <div>
          <h4>Newsletter</h4>
          <div style="display: flex; gap: 8px">
            <input id="newsEmail" placeholder="Email" /><button id="newsBtn">
              Subscribe
            </button>
          </div>
          <div id="newsOut" class="muted" style="margin-top: 6px"></div>
        </div>
      </div>
      <div
        class="container"
        style="padding: 10px 20px; border-top: 1px solid #10263b"
      >
        ¬© 2025 Kindora
      </div>
    </footer>

    <a class="wa" href="https://wa.me/1234567890" target="_blank" rel="noopener"
      >WhatsApp</a
    >
    <button id="toTop" class="btn">‚Üë Top</button>

    <script>
      const data = [
        {
          name: "Paris",
          cat: "city",
          img: "https://images.unsplash.com/photo-1502602898657-3e91760cbb34?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Tokyo",
          cat: "city",
          img: "https://images.unsplash.com/photo-1549692520-acc6669e2f0c?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Maldives",
          cat: "beach",
          img: "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Rome",
          cat: "city",
          img: "https://images.unsplash.com/photo-1523475472560-d2df97ec485c?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Switzerland",
          cat: "mountain",
          img: "https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "New York",
          cat: "city",
          img: "https://images.unsplash.com/photo-1505761671935-60b3a7427bad?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Santorini",
          cat: "beach",
          img: "https://images.unsplash.com/photo-1509125045885-5f3f81a8fc1a?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Bali",
          cat: "beach",
          img: "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Iceland",
          cat: "mountain",
          img: "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Dubai",
          cat: "city",
          img: "https://images.unsplash.com/photo-1526481280698-8fcc13fd92fd?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Sydney",
          cat: "city",
          img: "https://images.unsplash.com/photo-1506084868230-bb9d95c24759?auto=format&fit=crop&w=1920&q=80",
        },
        {
          name: "Phuket",
          cat: "beach",
          img: "https://images.unsplash.com/photo-1518544801976-3e188ed749b4?auto=format&fit=crop&w=1920&q=80",
        },
      ];
      const perPage = 6;
      let page = 0;
      let filtered = [...data];
      const grid = document.getElementById("grid");
      const loadMore = document.getElementById("loadMore");
      const search = document.getElementById("search");
      const category = document.getElementById("category");
      const sortSel = document.getElementById("sort");

      const trends = JSON.parse(localStorage.getItem("trends") || "{}");

      function render(reset = false) {
        if (reset) {
          grid.innerHTML = "";
          page = 0;
        }
        const start = page * perPage,
          end = start + perPage;
        const chunk = filtered.slice(start, end);
        chunk.forEach((item, i) => {
          const idx = start + i;
          const tile = document.createElement("div");
          tile.className = "tile reveal";
          tile.innerHTML = `<img loading="lazy" src="${item.img}" alt="${
            item.name
          }"><div class="cap">${item.name} ¬∑ ‚ù§ ${
            trends[item.name] || 0
          }</div><button class="btn ghost">View</button>`;
          tile.querySelector("button").onclick = () => openLightbox(idx);
          grid.appendChild(tile);
          setTimeout(() => tile.classList.add("show"), 60);
        });
        page++;
        loadMore.style.display =
          end < filtered.length ? "inline-block" : "none";
      }

      function applyFilters() {
        const q = search.value.toLowerCase();
        const cat = category.value;
        filtered = data.filter(
          (d) =>
            (cat === "all" || d.cat === cat) && d.name.toLowerCase().includes(q)
        );
        if (sortSel.value === "name")
          filtered.sort((a, b) => a.name.localeCompare(b.name));
        if (sortSel.value === "popular")
          filtered.sort(
            (a, b) => (trends[b.name] || 0) - (trends[a.name] || 0)
          );
        render(true);
      }

      search.oninput = applyFilters;
      category.onchange = applyFilters;
      sortSel.onchange = applyFilters;
      loadMore.onclick = () => render();

      /* Voice Search */
      document.getElementById("voice").onclick = () => {
        const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SR) return alert("Voice not supported");
        const r = new SR();
        r.lang = "en-US";
        r.start();
        r.onresult = (e) => {
          search.value = e.results[0][0].transcript;
          applyFilters();
        };
      };

      /* Lightbox */
      const lb = document.getElementById("lightbox");
      const lbImg = document.getElementById("lbImg");
      let current = 0;
      let slideInt = null;
      function openLightbox(i) {
        current = i;
        lb.style.display = "flex";
        updateLB();
        trends[filtered[current].name] =
          (trends[filtered[current].name] || 0) + 1;
        localStorage.setItem("trends", JSON.stringify(trends));
        applyFilters();
      }
      function updateLB() {
        lbImg.src = filtered[current].img;
      }
      document.getElementById("prev").onclick = () => {
        current = (current - 1 + filtered.length) % filtered.length;
        updateLB();
      };
      document.getElementById("next").onclick = () => {
        current = (current + 1) % filtered.length;
        updateLB();
      };
      document.getElementById("close").onclick = () => {
        lb.style.display = "none";
        stopSlide();
      };
      document.getElementById("dl").onclick = () => {
        const a = document.createElement("a");
        a.href = lbImg.src;
        a.download = "photo.jpg";
        a.click();
      };
      document.getElementById("fs").onclick = () => {
        if (lbImg.requestFullscreen) lbImg.requestFullscreen();
      };
      document.getElementById("slide").onclick = () => {
        if (slideInt) stopSlide();
        else
          slideInt = setInterval(
            () => document.getElementById("next").click(),
            4000
          );
      };
      function stopSlide() {
        clearInterval(slideInt);
        slideInt = null;
      }

      /* Countdown (set target date) */
      const target = new Date();
      target.setDate(target.getDate() + 10);
      function tick() {
        const now = new Date();
        let diff = target - now;
        if (diff < 0) diff = 0;
        const d = Math.floor(diff / 86400000),
          h = Math.floor((diff % 86400000) / 3600000),
          m = Math.floor((diff % 3600000) / 60000),
          s = Math.floor((diff % 60000) / 1000);
        ["d", "h", "m", "s"].forEach((id, i) =>
          document.getElementById(id).textContent([d, h, m, s][i])
        );
      }
      setInterval(tick, 1000);
      tick();

      /* Booking calc + currency via API with fallback */
      async function fxRate(from, to) {
        try {
          const r = await fetch(
            `https://api.exchangerate.host/latest?base=${from}&symbols=${to}`
          );
          const j = await r.json();
          return j.rates[to] || 1;
        } catch (e) {
          const table = {
            USD: { INR: 84, EUR: 0.9 },
            INR: { USD: 0.012, EUR: 0.0119 },
            EUR: { USD: 1.1, INR: 92 },
          };
          return (table[from] && table[from][to]) || 1;
        }
      }
      async function calc() {
        const sel = document.getElementById("dest");
        const base = Number(sel.selectedOptions[0].dataset.base);
        const nights = Number(document.getElementById("nights").value || 1);
        const pax = Number(document.getElementById("pax").value || 1);
        let total = base * nights * pax;
        const code = document
          .getElementById("coupon")
          .value.trim()
          .toUpperCase();
        const disc = code === "SUMMER10" ? 0.1 : code === "WINTER15" ? 0.15 : 0;
        total *= 1 - disc;
        const ccy = document.getElementById("ccy").value;
        const rate = await fxRate("USD", ccy);
        const out = (total * rate).toFixed(2);
        document.getElementById(
          "price"
        ).textContent = `Estimated: ${ccy} ${out}`;
      }
      document.getElementById("calc").onclick = calc;
      document.getElementById("ccy").onchange = calc;
      document.getElementById("dest").onchange = calc;
      document.getElementById("nights").oninput = calc;
      document.getElementById("pax").oninput = calc;
      calc();

      document.getElementById("book").onclick = () => {
        alert("Demo booking created! We'll email you details.");
      };

      /* Itinerary generator */
      const ideas = {
        city: ["City tour", "Museum", "Food walk", "Skyline viewpoint"],
        beach: ["Snorkeling", "Sunset cruise", "Beach day", "Seafood market"],
        mountain: [
          "Scenic hike",
          "Lakes & valleys",
          "Cable car ride",
          "Local village tour",
        ],
      };
      document.getElementById("genPlan").onclick = () => {
        const days = Number(document.getElementById("days").value || 1);
        const dest = document.getElementById("dest").value;
        const cat = (data.find((d) => d.name === dest) || { cat: "city" }).cat;
        const plan = document.getElementById("plan");
        plan.innerHTML = "";
        for (let i = 1; i <= days; i++) {
          const div = document.createElement("div");
          div.className = "day";
          const act = ideas[cat][(i - 1) % ideas[cat].length];
          div.innerHTML = `<b>Day ${i}</b>: ${act}`;
          plan.appendChild(div);
        }
      };

      /* Weather (OpenWeatherMap) */
      document.getElementById("getWx").onclick = async () => {
        const city = document.getElementById("wxCity").value || "Paris";
        const key = "YOUR_OPENWEATHERMAP_KEY";
        try {
          const r = await fetch(
            `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(
              city
            )}&appid=${key}&units=metric`
          );
          const j = await r.json();
          if (j.main) {
            document.getElementById(
              "weather"
            ).textContent = `${j.name}: ${j.main.temp}¬∞C, ${j.weather[0].description}`;
          } else {
            document.getElementById("weather").textContent =
              "Add your API key to enable weather.";
          }
        } catch (e) {
          document.getElementById("weather").textContent =
            "Weather unavailable.";
        }
      };

      /* Currency converter tool */
      document.getElementById("fx").onclick = async () => {
        const amt = Number(document.getElementById("amt").value || 0);
        const from = document.getElementById("fromC").value;
        const to = document.getElementById("toC").value;
        const rate = await fxRate(from, to);
        document.getElementById("fxOut").textContent = `${to} ${(
          amt * rate
        ).toFixed(2)} (rate ${rate.toFixed(4)})`;
      };

      /* Map quick picks */
      const mapData = [
        "Paris",
        "Tokyo",
        "Maldives",
        "Rome",
        "Switzerland",
        "New York",
        "Santorini",
        "Bali",
        "Iceland",
        "Dubai",
      ];
      const mapGrid = document.getElementById("mapGrid");
      mapData.forEach((n) => {
        const d = document.createElement("div");
        d.className = "map-card";
        d.innerHTML = `<b>${n}</b><div class=muted>Tap to view in Gallery</div>`;
        d.onclick = () => {
          search.value = n;
          applyFilters();
          window.location.hash = "#gallery";
        };
        mapGrid.appendChild(d);
      });

      /* Poll */
      const pollKey = "pollVotes";
      const poll = JSON.parse(
        localStorage.getItem(pollKey) || '{"beach":0,"mountain":0,"city":0}'
      );
      document.querySelectorAll("[data-poll]").forEach(
        (b) =>
          (b.onclick = () => {
            const k = b.dataset.poll;
            poll[k]++;
            localStorage.setItem(pollKey, JSON.stringify(poll));
            renderPoll();
          })
      );
      function renderPoll() {
        const total = Object.values(poll).reduce((a, b) => a + b, 0) || 1;
        const beach = Math.round((poll.beach / total) * 100);
        document.getElementById("pollBar").style.width = beach + "%";
        document.getElementById(
          "pollOut"
        ).textContent = `Beaches ${beach}%, Mountains ${Math.round(
          (poll.mountain / total) * 100
        )}%, Cities ${Math.round((poll.city / total) * 100)}%`;
      }
      renderPoll();

      /* Reviews (localStorage) */
      const revKey = "reviews";
      const revOut = document.getElementById("reviews");
      function drawReviews() {
        revOut.innerHTML = "";
        const arr = JSON.parse(localStorage.getItem(revKey) || "[]");
        arr.forEach((r) => {
          const d = document.createElement("div");
          d.className = "review";
          d.innerHTML = `<b>${r.name}</b> <span class=stars>${"‚òÖ".repeat(
            r.stars
          )}${"‚òÜ".repeat(5 - r.stars)}</span><div>${r.text}</div>`;
          revOut.appendChild(d);
        });
      }
      drawReviews();
      document.getElementById("addReview").onclick = () => {
        const name = document.getElementById("rName").value || "Anonymous";
        const stars = Number(document.getElementById("rStars").value);
        const text = document.getElementById("rText").value || "";
        const arr = JSON.parse(localStorage.getItem(revKey) || "[]");
        arr.unshift({ name, stars, text });
        localStorage.setItem(revKey, JSON.stringify(arr));
        drawReviews();
      };

      /* Newsletter (local demo) */
      document.getElementById("newsBtn").onclick = () => {
        const v = document.getElementById("newsEmail").value;
        document.getElementById("newsOut").textContent = v
          ? `Thanks! We\'ll email ${v}`
          : "Enter a valid email";
      };

      /* Back to top */
      document.getElementById("toTop").onclick = () =>
        window.scrollTo({ top: 0, behavior: "smooth" });

      /* Top progress bar */
      window.addEventListener("scroll", () => {
        const sc = window.scrollY,
          h = document.body.scrollHeight - window.innerHeight;
        document.getElementById("progress").style.width = (sc / h) * 100 + "%";
      });

      /* Reveal on scroll */
      const io = new IntersectionObserver(
        (es) =>
          es.forEach((e) => {
            if (e.isIntersecting) {
              e.target.classList.add("show");
              io.unobserve(e.target);
            }
          }),
        { threshold: 0.1 }
      );
      document.querySelectorAll(".reveal").forEach((el) => io.observe(el));

      /* Counters animate */
      const counters = document.querySelectorAll(".counter b");
      const io2 = new IntersectionObserver(
        (es) =>
          es.forEach((e) => {
            if (!e.isIntersecting) return;
            const el = e.target;
            const max = Number(el.dataset.count);
            let n = 0;
            const t = setInterval(() => {
              n += Math.ceil(max / 60);
              if (n >= max) {
                n = max;
                clearInterval(t);
              }
              el.textContent = n;
            }, 16);
            io2.unobserve(el);
          }),
        { threshold: 0.6 }
      );
      counters.forEach((c) => io2.observe(c));

      /* Theme */
      const modeBtn = document.getElementById("mode");
      function setTheme(dark) {
        document.documentElement.classList.toggle("dark", dark);
        localStorage.setItem("dark", dark ? 1 : 0);
        modeBtn.textContent = dark ? "‚òÄÔ∏è" : "üåô";
      }
      setTheme(localStorage.getItem("dark") === "1");
      modeBtn.onclick = () =>
        setTheme(!document.documentElement.classList.contains("dark"));

      /* Service Worker (PWA-lite) via Blob */
      if ("serviceWorker" in navigator) {
        const swCode = `self.addEventListener('install',e=>{e.waitUntil(caches.open('kindora').then(c=>c.addAll(['/'])))});self.addEventListener('fetch',e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)))})`;
        const blob = new Blob([swCode], { type: "text/javascript" });
        const url = URL.createObjectURL(blob);
        navigator.serviceWorker.register(url);
      }

      /* Init */
      applyFilters();
    </script>
  </body>
</html>
